# Historical Data Pipeline: AI-Assisted JSON Validator

This system transitions raw AI-extracted text from historical medical reports into structured, research-ready JSON datasets through a human-in-the-loop validation interface.

---

## Project Architecture

| Directory | Purpose |
| :--- | :--- |
| **`01_pdf`** | Storage for original digitized source documents and scanned historical reports. |
| **`02_json_raw`** | Landing zone for the raw JSON output generated by the AI prompt (contains dimensions or initial skeletons). |
| **`03_json_processed`** | Final repository for manually verified and structured datasets, saved directly by the Shiny app. |

---

## Core Components

* **`ai_prompt.txt`**: The specific prompt used to extract structural dimensions (Institutions, Diagnoses, Year) from the source PDF.
* **`app.R`**: The interactive Shiny validation tool. It serves as the bridge between raw AI output and the final dataset, handling grid expansion, data entry, and structural formatting.
* **`skeleton_generator`**: The internal logic within `app.R` that automatically expands a simple list of dimensions into a full Cartesian product (grid) for data entry.

---

## Features

### 1. Dual-Pathway Import
The application intelligently detects the type of JSON file uploaded:
* **Dimensions Mode:** Upload a simple list of headers (Institutions, Diagnoses) from the AI. The app automatically "puffs up" this list into a full, empty grid ready for data entry.
* **Resume Mode:** Upload a previously saved `_processed.json` file to restore the full dataset, including all values and footnotes, for continued editing.

### 2. Dual-Grid Editing System
To maintain data purity, information is split into two synchronized views:
* **Data Grid:** Strictly for numeric values.
* **Footnote Grid:** For capturing non-numeric markers (e.g., `*`, `1)`, `a`).
* *Visual Feedback:* Cells containing footnotes are automatically flagged with a visual indicator in the main Data Grid.

### 3. Global Dimension Management
* **Renaming Tools:** Dedicated panels allow you to rename an Institution or Diagnosis once and have that change propagate instantly across the entire dataset (both Data and Footnote grids).

### 4. Structured JSON Export
* **Hierarchical Output:** Data is saved not as a flat CSV, but as a nested JSON object preserving the relationship between metadata, dimensions, and cell-specific attributes (value + footnote).
* **Server-Side Saving:** A single click saves the validated file directly to the `03_json_processed` directory with a standardized naming convention (`filename_processed.json`).